# 604. Design Compressed String Iterator

post condition of advance\(\): pointer points to either out of boundary or to a character

```python
class StringIterator(object):
    # !!! think about the case the input is a stream (iterator)
    def __init__(self, compressedString):
        self.string = compressedString
        self.curChar = ' '
        self.curCount = 0
        self.curPos = 0

    def next(self):
        self._advance()
        self.curCount = max(self.curCount - 1, 0)
        return self.curChar

    def hasNext(self):
        self._advance()
        # bug: originally self.curPos < len
        return self.curCount > 0
    
    def _readInt(self):
        assert self.string[self.curPos].isdigit() # pre-condition
        buffer = []
        while self.curPos < len(self.string) and self.string[self.curPos].isdigit():
            buffer.append(self.string[self.curPos])
            self.curPos += 1
        # post: self.curPos == len or current pos point to a char
        return int(''.join(buffer))
    
    def _advance(self):
        # precondition: curPos >= len(string), string[curPos] is not a digit
        n = len(self.string)
        while self.curPos < n and self.curCount == 0:
            self.curChar = self.string[self.curPos] # bug, typo: self.curChar -> self.Cur (py pitfall)
            self.curPos += 1
            self.curCount = self._readInt()
        if self.curPos >= n and self.curCount == 0: # bug: 
            self.curChar = ' '
        # post-condition: curPos >= len(string) or curCount > 0
```



### 

