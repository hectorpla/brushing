# 385. Mini Parser

very buggy code following: wanted to use iterator pattern, but not beneficial a lot \(should **look** **ahead** \)

a better impl using the iterator idea

```text
def deserialize(self, s):
    it = iter(s)
    ahead = next(it)
    
    def isDigit(s):
        return s.isdigit() or s == '-'
    
    def readInteger():
        nonlocal ahead
        # assume ahead is a digit part
        buffer = [ahead]
        while True:
            try:
                ahead = next(it)
            except:
                break
            if not isDigit(ahead):
                break
            buffer.append(ahead)
        return NestedInteger(int(''.join(buffer)))
        
    stack = [NestedInteger()]
    while True:
        if ahead == '[':
            stack.append(NestedInteger())
        elif isDigit(ahead):
            stack[-1].add(readInteger())
            if isDigit(ahead): break # weird
            continue # bug: case "123"
        else: # ',', ']'
            if ahead == ']':
                stack[-2].add(stack.pop())
        try:
            ahead = next(it)
        except:
            break
    return stack[0].getList()[0]
```

